{% extends 'base.html.twig' %}

{% block title %}ðŸ‘¥ Liste des utilisateurs{% endblock %}
{% block body_class %}after-login{% endblock %}

{% block body %}
  <header>
    <div class="user-info">
      <strong>{{ app.session.get('user_nom') }}</strong><br>
      <small>{{ app.session.get('user_role') }}</small>
    </div>
    <nav class="nav-links">
      <a href="{{ path('app_choisir_backup_path') }}" class="btn blue">ðŸ“¥ Chemin de la BDD</a>
      <a href="{{ path('app_monespace') }}" class="btn blue">ðŸ‘¤ Mon espace</a>
      <a href="{{ path('app_logout') }}" class="btn red">ðŸšª DÃ©connexion</a>
    </nav>
  </header>

  <h1>ðŸ‘¥ Liste des utilisateurs</h1>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Email</th>
        <th>TÃ©lÃ©phone</th>
        <th>RÃ´le</th>
        <th>Statut</th>
        <th>BloquÃ©</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for user in utilisateurs %}
        <tr>
          <td>{{ user.id }}</td>
          <td>{{ user.nom }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.tel }}</td>
          <td>{{ user.role }}</td>
          <td>{{ user.statut }}</td>
          <td>
            {% if user.bloque == 'oui' %}
              <span style="color: red; font-weight: bold;">Oui</span>
            {% else %}
              <span style="color: green; font-weight: bold;">Non</span>
            {% endif %}
          </td>
          <td>
            <form method="post" action="{{ path('toggle_user_block', {'id': user.id}) }}"
                  onsubmit="return confirm('{{ user.bloque == 'non' ? 'Bloquer' : 'DÃ©bloquer' }} cet utilisateur ?');">
              <button type="submit"
                      class="table-button {{ user.bloque == 'non' ? 'delete' : 'manage' }}">
                {{ user.bloque == 'non' ? 'ðŸš« Bloquer' : 'âœ… DÃ©bloquer' }}
              </button>
            </form>
          </td>
        </tr>
      {% else %}
        <tr>
          <td colspan="8" class="text-center">Aucun utilisateur trouvÃ©.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
